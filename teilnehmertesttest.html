<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Gameshow — Teilnehmer</title>
<style>
html, body {
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  font-family:'Segoe UI',sans-serif;
  background:#0a0612;
  color:#e0caff;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* Top Container */
.top {
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:start;
  gap:16px;
}

/* Frage Box */
.frage-box {
  background:#1a0d2e;
  color:#c6a8ff;
  border-radius:35px;
  width:400px;
  height:200px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-size:2rem;
  text-align:center;
  white-space: pre-line;
  padding:20px;
  transition: all 0.8s ease;
  margin-bottom:30px;
}
.frage-box .question{transition: all 0.5s ease;}
.frage-box.shrink .question{font-size:1.2rem;}

/* Runde */
.runde {
  background:#000;
  color:#c6a8ff;
  padding:10px 25px;
  border-radius:25px;
  font-size:1.2rem;
  align-self:center;
  justify-self:center;
  position:relative;
}

/* Mod Box */
.mod-box {
  background:#6a4c8d;
  border-radius:25px;
  width:240px;
  height:180px;
  position:absolute;
  top:0;
  right:0;
  display:flex;
  justify-content:center;
  align-items:center;
}
.mod-label {
  background:#fff;
  color:#9f86ff;
  padding:6px 20px;
  border-radius:20px;
  position:absolute;
  bottom:-20px;
  left:50%;
  transform:translateX(-50%);
  font-size:0.95rem;
  font-weight:bold;
}

/* Spieler Grid */
.spieler-grid {
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  gap:20px;
  position:relative;
}
.spieler {
  background:#6a4c8d;
  border-radius:25px;
  height:160px;
  display:flex;
  flex-direction: column;
  justify-content:center;
  align-items:center;
  position:relative;
  padding:10px;
  color:#9f86ff;
}
.spieler-info {
  display:flex;
  align-items:center;
  gap:9px;
  background:#fff;
  color:#fa0c9e;
  border-radius:20px;
  padding:6px 12px;
  font-weight:bold;
  font-size:0.95rem;
  margin-top:195px;
}

/* Kameras Container */
.kameras {
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:10;
}
.kameras div {
  position:absolute;
  border:2px solid #9f86ff;
  border-radius:12px;
  overflow:hidden;
}
.kameras iframe {
  width:100%;
  height:100%;
  border:none;
}

/* Jede Cam über dem jeweiligen Spieler */
#cam1 { top:50px; left:calc(0% + 50px); width:200px; height:150px; }  /* Nele */
#cam2 { top:50px; left:calc(25% + 50px); width:200px; height:150px; } /* Vullco */
#cam3 { top:50px; left:calc(50% + 50px); width:200px; height:150px; } /* Paya */
#cam4 { top:50px; left:calc(75% + 50px); width:200px; height:150px; } /* Lian */
#cam5 { top:10px; right:50px; width:200px; height:150px; }             /* Bonuscam / Moderator */

</style>
</head>
<body>

<div id="fakeOverlay">Are you Ready for it?</div>

<div class="stage-wrapper">
  <div class="stage">
    <div class="top">
      <div class="frage-box" id="frage">
        <div class="question">FRAGEN</div>
      </div>
      <div class="runde">runde: <span id="runde">xy</span></div>
    </div>
    <div class="mod-box">
      <div class="mod-label">Neneli</div>
    </div>

    <div class="spieler-grid">
      <div class="spieler"><div class="spieler-info"><span>Nele</span><span class="score" id="s0">0</span></div></div>
      <div class="spieler"><div class="spieler-info"><span>Vullco</span><span class="score" id="s1">0</span></div></div>
      <div class="spieler"><div class="spieler-info"><span>Paya</span><span class="score" id="s2">0</span></div></div>
      <div class="spieler"><div class="spieler-info"><span>Lian</span><span class="score" id="s3">0</span></div></div>
    </div>
  </div>
</div>

<!-- 5 getrennte Kameras über Spielern -->
<div class="kameras">
  <div id="cam1">
    <iframe src="https://vdo.ninja/?view=Kamera1&room=topappleW&viewonly=true&quality=1080&fps=30&autoplay=true"
            allow="autoplay; fullscreen"></iframe>
  </div>
  <div id="cam2">
    <iframe src="https://vdo.ninja/?view=Kamera2&room=topappleW&viewonly=true&quality=1080&fps=30&autoplay=true"
            allow="autoplay; fullscreen"></iframe>
  </div>
  <div id="cam3">
    <iframe src="https://vdo.ninja/?view=Kamera3&room=topappleW&viewonly=true&quality=1080&fps=30&autoplay=true"
            allow="autoplay; fullscreen"></iframe>
  </div>
  <div id="cam4">
    <iframe src="https://vdo.ninja/?view=Kamera4&room=topappleW&viewonly=true&quality=1080&fps=30&autoplay=true"
            allow="autoplay; fullscreen"></iframe>
  </div>
  <div id="cam5">
    <iframe src="https://vdo.ninja/?view=Kamera5&room=topappleW&viewonly=true&quality=1080&fps=30&autoplay=true"
            allow="autoplay; fullscreen"></iframe>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA12xVYrWgvIPmPi4dvpjYwlkopmz-CrSA",
  authDomain: "pssst-ba817.firebaseapp.com",
  projectId: "pssst-ba817",
  storageBucket: "pssst-ba817.firebasestorage.app",
  messagingSenderId: "182141979805",
  appId: "1:182141979805:web:d85619677fe2804e811874"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const stageWrapper = document.querySelector(".stage-wrapper");
const frage=document.getElementById("frage");
const runde=document.getElementById("runde");
const questionDiv=frage.querySelector(".question");
const fakeOverlay=document.getElementById("fakeOverlay");

function scaleStage(){
  const scaleX = window.innerWidth / 1000;
  const scaleY = window.innerHeight / 600;
  const scale = Math.min(scaleX, scaleY);
  stageWrapper.style.transform = `scale(${scale})`;
}
window.addEventListener("resize", scaleStage);
scaleStage();

onSnapshot(doc(db,"games","current"),snap=>{
  if(!snap.exists()) return;
  const d=snap.data();
  let state=d.fakeState||1;

  if(state===1){
    fakeOverlay.style.opacity="1";
    fakeOverlay.textContent="Are you Ready for it...?";
    frage.style.opacity=0;
  } else {
    fakeOverlay.style.opacity="0";
    frage.style.opacity=1;

    const q=d.questions[d.questionIndex]||{};
    if(d.revealed){
      frage.classList.add("shrink");
      questionDiv.style.fontSize="1.2rem";
      if(!frage.querySelector(".answer")){
        const ansDiv=document.createElement("div");
        ansDiv.className="answer";
        ansDiv.textContent=q.answer||"Keine Antwort";
        frage.appendChild(ansDiv);
      } else {
        frage.querySelector(".answer").textContent=q.answer||"Keine Antwort";
      }
    } else {
      frage.classList.remove("shrink");
      questionDiv.style.fontSize="2rem";
      questionDiv.textContent=q.text||"Keine Frage mehr.";
      const ansDiv=frage.querySelector(".answer");
      if(ansDiv) ansDiv.remove();
    }
    runde.textContent=d.roundName||d.questionIndex+1;
    (d.scores||[]).forEach((v,i)=>document.getElementById("s"+i).textContent=v);
  }
});
</script>
</body>
</html>
